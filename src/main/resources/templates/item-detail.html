<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${item.title} + ' - SPEC'">å•†å“è©³æƒ…</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="icon" type="image/x-icon" th:href="@{/favicon.ico?v=2}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

    <style>
        .product-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 20px;
        }

        .product-image-area {
            background: #e0e0e0;
            border: 2px solid var(--text-main);
            height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #888;
            position: relative;
            overflow: hidden;
        }

        .product-info-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .product-title {
            font-family: 'Archivo Black', sans-serif;
            font-size: 2.5rem;
            line-height: 1.1;
            margin: 0;
            text-transform: uppercase;
        }

        /* åƒ¹æ ¼å€å¡Š */
        .product-price-box {
            background: #fafafa;
            padding: 20px;
            border: 1px solid #ddd;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .price-large {
            font-family: 'Archivo Black', sans-serif;
            font-size: 3rem;
            color: var(--text-main);
            /* åƒ¹æ ¼ highlight */
            background: linear-gradient(120deg, transparent 0%, transparent 10%, var(--highlight) 10%, var(--highlight) 90%, transparent 90%);
        }

        .info-row {
            display: grid;
            grid-template-columns: 120px 1fr;
            gap: 10px;
            font-size: 0.95rem;
            margin-bottom: 10px;
            align-items: baseline;
        }

        .info-label {
            color: #666;
            font-weight: bold;
        }

        .info-value {
            color: var(--text-main);
        }

        .divider {
            height: 1px;
            background: #ddd;
            margin: 10px 0;
            border: none;
        }

        .action-box {
            margin-top: 20px;
            padding: 20px;
            border: 2px solid var(--text-main);
            background: white;
            box-shadow: 8px 8px 0 rgba(0,0,0,0.1);
        }

        @media (max-width: 768px) {
            .product-layout { grid-template-columns: 1fr; }
            .product-image-area { height: 300px; }
        }
    </style>
</head>
<body>

<div class="navbar">
    <a th:href="@{/}" class="logo">HobbySwap</a>

    <div class="nav-links">

        <div class="nav-right-group" style="display: flex; align-items: center; gap: 20px;">

            <div class="lang-dropdown">
                <button class="lang-btn">
                    <span>ğŸŒ LANGUAGE â–¼</span>
                </button>
                <div class="lang-content">
                    <a th:href="@{?lang=zh_TW}">ç¹é«”ä¸­æ–‡ [TW]</a>
                    <a th:href="@{?lang=en}">ENGLISH [EN]</a>
                    <a th:href="@{?lang=ja}">æ—¥æœ¬èª [JP]</a>
                </div>
            </div>

            <span th:if="${#authentication.principal != 'anonymousUser'}"
                  style="display:flex; align-items:center; gap: 20px;">

        <span style="font-family:'Space Mono'; font-weight:bold; font-size: 0.9rem;">
             <span th:text="${#authentication.name}" style="background:var(--highlight); padding:2px 5px; color:black;">User</span>
        </span>

        <a th:href="@{/private-chat}" class="btn"
           style="height:40px; padding:0 15px; font-size:0.9rem; display: inline-flex; align-items: center; justify-content: center;"
           th:text="#{nav.private_chat}">
           Private Chat
        </a>

        <a th:href="@{/chat}" class="btn"
           style="height:40px; padding:0 15px; font-size:0.9rem; display: inline-flex; align-items: center; justify-content: center;"
           th:text="#{nav.chat}">
           CHAT
        </a>

        <a th:href="@{/items/new}" class="btn"
           style="height:40px; padding:0 15px; font-size:0.9rem; display: inline-flex; align-items: center; justify-content: center;"
           th:text="#{nav.sell}">
           SELL
        </a>

        <form th:action="@{/logout}" method="post" style="display:flex; align-items:center;">
            <button type="submit" class="btn-logout" th:text="#{nav.logout}">LOGOUT</button>
        </form>
    </span>
        </div>
    </div>
</div>

<div class="container">
    <a th:href="@{/}" class="back-link" th:text="#{item.back}">&larr; å›é¦–é </a>

    <div class="product-layout">

        <div class="product-image-area">
            <img th:if="${item.imageName != null}"
                 th:src="@{'/uploads/' + ${item.imageName}}"
                 style="width: 100%; height: 100%; object-fit: cover;">

            <span th:if="${item.imageName == null}">
                NO IMAGE DATA
            </span>
        </div>

        <div class="product-info-area">

            <h1 class="product-title" th:text="${item.title}">å•†å“åç¨±</h1>

            <div class="product-price-box">
                <span class="price-large" th:text="'$ ' + ${item.price}">$ 1000</span>
                <span th:if="${item.status == 'SOLD'}" class="sold-stamp" style="position:static; transform:none; font-size:1.5rem; padding:5px 10px; border-width:2px;" th:text="#{item.sold}">SOLD</span>
            </div>

            <hr class="divider">

            <div>
                <h4 style="margin: 10px 0; text-decoration: underline;" th:text="#{item.shipping}">é‹é€è³‡è¨Š</h4>

                <div class="info-row">
                    <span class="info-label" th:text="#{item.shipping_from}">å‡ºè²¨åœ°é»</span>
                    <span class="info-value">Taipei, Taiwan</span>
                </div>

                <div class="info-row">
                    <span class="info-label" th:text="#{item.shipping_fee}">é‹è²»</span>
                    <span class="info-value">$ 60 (7-11 / FamilyMart)</span>
                </div>

                <div class="info-row">
                    <span class="info-label" th:text="#{item.shipping_est}">é è¨ˆé€é”</span>
                    <span class="info-value">3 - 5 Days (After Shipment)</span>
                </div>
            </div>

            <hr class="divider">

            <div>
                <h4 style="margin: 10px 0; text-decoration: underline;" th:text="#{item.spec}">å•†å“è¦æ ¼</h4>

                <div class="info-row">
                    <span class="info-label" th:text="#{item.condition}">å•†å“ç‹€æ³</span>
                    <span class="info-value">Used - Good</span>
                </div>

                <div class="info-row">
                    <span class="info-label" th:text="#{item.date}">ä¸Šæ¶æ™‚é–“</span>
                    <span class="info-value"
                          th:text="${#temporals.format(item.uploadDate, 'yyyy-MM-dd')}">
            2023-01-01
        </span>
                </div>

                <div class="info-row" style="align-items: flex-start;">
                    <span class="info-label" th:text="#{item.desc}">æè¿°</span>
                    <span class="info-value" th:text="${item.description}" style="white-space: pre-wrap;">å•†å“æè¿°å…§å®¹...</span>
                </div>
            </div>

            <div class="action-box" th:if="${item.status == 'ON_SALE'}">
                <div class="info-row">
                    <span class="info-label" th:text="#{item.payment}">ä»˜æ¬¾æ–¹å¼</span>
                    <span class="info-value" th:text="#{item.payment_desc}">Credit / ATM</span>
                </div>

                <div th:if="${#authentication.principal == 'anonymousUser'}" style="text-align: center; margin-top: 15px;">
                    <a th:href="@{/login}" class="btn" th:text="#{nav.login}">LOGIN</a>
                    <span style="margin-left: 10px;" th:text="#{item.login_first}">to buy</span>
                </div>

                <div th:if="${#authentication.principal != 'anonymousUser'}">

                    <div th:if="${#authentication.name != item.seller.email}">
                        <form th:action="@{'/items/' + ${item.id} + '/buy'}" method="post">
                            <button type="submit" class="btn"
                                    style="width: 100%; font-size: 1.2rem; padding: 15px;"
                                    th:text="#{item.buy}">
                                BUY NOW
                            </button>
                        </form>
                    </div>

                    <div th:if="${#authentication.name == item.seller.email}"
                         style="text-align: center; margin-top: 15px; padding: 10px; background: #eee; color: #666; border: 1px dashed #ccc;">

            <span style="font-weight: bold;" th:text="#{item.self_buy_error}">
                ğŸš« è³£å®¶ç„¡æ³•è³¼è²·è‡ªå·±çš„å•†å“
            </span>

                    </div>

                </div>
            </div>

            <div class="action-box" th:if="${item.status == 'SOLD'}" style="background: #f0f0f0; border-color: #ccc;">
                <h2 style="color: #999; text-align: center; margin: 0;" th:text="#{item.sold}">SOLD OUT</h2>
            </div>

            <div class="action-box"
                 th:if="${#authentication.name == item.seller.email}"
                 style="margin-top: 20px; border-color: #FF3333; background: #FFF0F0;">

                <h4 style="margin-top: 0; color: #FF3333; text-decoration: underline;"
                    th:text="#{item.manage.title}">
                    MANAGE ITEM (è³£å®¶åŠŸèƒ½)
                </h4>

                <p style="font-size: 0.9rem; color: #666; margin-bottom: 15px;"
                   th:text="#{item.manage.desc}">
                    æ‚¨å¯ä»¥å°‡æ­¤å•†å“ä¸‹æ¶ (åˆªé™¤)ï¼Œæ­¤å‹•ä½œç„¡æ³•å¾©åŸã€‚
                </p>

                <form th:action="@{'/items/' + ${item.id} + '/delete'}" method="post"
                      th:onsubmit="|return confirm('#{item.manage.confirm}');|">

                    <button type="submit" class="btn"
                            style="width: 100%; background: #FF3333; border-color: #FF3333; color: white !important;"
                            th:text="#{item.manage.delete}">
                        âŒ ä¸‹æ¶å•†å“ (DELETE)
                    </button>
                </form>
            </div>

        </div>
    </div>
</div>

<footer class="footer">
    <div class="footer-grid">
        <div class="footer-col">
            <h4 th:text="#{footer.company}">COMPANY</h4>
            <ul class="footer-links">
                <li><a href="#" th:text="#{footer.brand}">é—œæ–¼æˆ‘å€‘ BRAND STORY</a></li>
                <li><a href="#" th:text="#{footer.store}">é–€å¸‚è³‡è¨Š STORE</a></li>
                <li><a href="#" th:text="#{footer.privacy}">éš±ç§æ¬Šæ”¿ç­– PRIVACY</a></li>
                <li><a href="#" th:text="#{footer.terms}">æœå‹™æ¢æ¬¾ TERMS</a></li>
            </ul>
        </div>

        <div class="footer-col">
            <h4 th:text="#{footer.service}">SERVICE</h4>
            <ul class="footer-links">
                <li><a href="#" th:text="#{footer.faq}">å¸¸è¦‹å•é¡Œ FAQ</a></li>
                <li><a href="#" th:text="#{footer.delivery}">é‹é€æ”¿ç­– DELIVERY</a></li>
                <li><a href="#" th:text="#{footer.return}">é€€æ›è²¨æœå‹™ RETURN</a></li>
                <li><a href="#" th:text="#{footer.vip}">æœƒå“¡åˆ¶åº¦ VIP</a></li>
            </ul>
        </div>

        <div class="footer-col">
            <h4 th:text="#{footer.contact}">CONTACT US</h4>
            <div class="contact-info">
                <p><strong>TEL:</strong> 02-9487-5566</p>
                <p><strong>EMAIL:</strong> help@hobbyswap.com</p>
                <p><strong>TIME:</strong> MON - SUN / 11:00 - 20:00</p>
            </div>
        </div>

        <div class="footer-col">
            <h4 th:text="#{footer.follow}">FOLLOW US</h4>
            <div class="social-links">
                <a href="#">[ IG ]</a>
                <a href="#">[ FB ]</a>
                <a href="#">[ YT ]</a>
            </div>
        </div>
    </div>

    <div class="copyright">
        <div>
            &copy; <span th:text="#{footer.copyright}">2025 HOBBYSWAP SUPPLY. ALL RIGHTS RESERVED.</span>
        </div>
        <div class="payment-icons">
            <span>VISA</span>
            <span>MASTER</span>
            <span>JCB</span>
            <span>APPLE PAY</span>
        </div>
    </div>
</footer>

</body>
</html>